---
title: '[RPA] 噂のRPAがかなり酷かった話'
date: 2018-07-09 01:47:03
tags:
- rpa
---

最近 RPA（Robotic Process Automation）が流行っている。「ルーチンワークは RPA で自動化！」と言うと聞こえはいいが、本当に効果はあるのだろうか？

自社で RPA を導入した際に触れる機会があったのだが、巷で謳われているようなメリット溢れる RPA と現実の実物にあまりにも乖離があったので、RPA の問題点を中心に考えてみたい。

<!-- more -->

…というのは建前で、導入した RPA があまりに酷かったのでここで鬱憤を吐き出す。

# おことわり

- この記事はとある RPA ソフトに触れてみた感想からできています。
- その為、RPA の悪い点としている部分がその"特定のソフト"に偏向している場合があります。
- 完全にプログラマ視点です。
- これは RPA ネガティブキャンペーン記事ですので、そのつもりで読んで下さい。

# 強い制約

RPA を使うにあたり、業務に応じて柔軟に利用…とは言えない、非常に厳しい制約がいくつかある。

## デジタル化済みが前提

当たり前と言っては当たり前なんだけど、パソコンのソフトウェアなのでパソコン内で完結する作業しか自動化できない。紙のインプット、紙のアウトプットな業務は RPA できないので、業務のペーパーレス化が進んでいることが前提条件になる。

## 人との同居はできない

業務の自動化と言うのだから、自分は PC を使って仕事をしている裏で RPA がガリガリ仕事を進めてくれるのを想像していたが、そうではない。RPA が起動したタイミングで PC の操作ハンドルは奪われる。（厳密には奪われないが、RPA 処理中に何か操作をすると一発でエラー停止する）つまり人が普段使用している PC に RPA は入れることができず、専用 PC で動かすことになる。

## 並列実行もできない

RPA の処理は「シナリオに沿ってキーボード・マウスの入力をエミュレートする」ものであるから、ブラウザを操作する場合はブラウザが立ち上がるし、マウスカーソルもシナリオ通りに動く。シングルスレッドでしか動作できないので別のシナリオを並列実行できないということだ。

ここで一番問題だと思う点は、シナリオの起動をマネージする仕組みがないことだ。シナリオ起動方法は 2 つあり、PC 上でシナリオ開始を叩くか、Windows タスクマネージャで指定時間になったら起動させるかだ。何十もあるシナリオを毎回人力で起動するのはあまりにナンセンスなので、タスクマネージャで時間指定することになるだろう。

例えば 0:00 にシナリオ A と 0:10 にシナリオ B をタスクマネージャに登録しておくとする。この時シナリオ A の実行に 10 分以上かかった場合どうなるだろうか？正解はシナリオ B が実行されない、だ。そしてシナリオ B が実行されなかった事実は画面を見ていないと検知できない。必然的にシナリオ間の開始時間は十分なバッファが必要になるし、そもそも動作時間が予測できないシナリオはどこで開始させればいいのか判断にこまるだろう。

## アップデートもできない

RPA では操作対象の状態を識別する手段として「画像マッチング」という方法がある。操作対象の処理結果だったり、画面遷移の有無だったりを「画像」として判別する方法だが、基本的に用意した画像と**完全一致**しなければならない。なのでアップデート等で操作対象の GUI が変わってはいけないし、セキュリティソフトの通知が入ってもダメだし、OS のアップグレードでスタートメニューやタスクバーの表示が変わってもダメだ。

そして Web に接続する必要がある業務では、アップデート禁止は実際無理であろう。

# 難しいシナリオ作成

説明が前後してしまうが、RPA で一つの業務を担う場合、その業務をフローチャート化して実行する。この単位をシナリオという。

このシナリオに関しても作成するのには一筋縄ではいかない。

## 非常に不安定な判定

前述の「画像マッチング」だが、非常に繊細ですぐにマッチングエラーとなる。

理屈としては手動で実行した際の画面を画像として保存しておき、次に自動実行した際は必ず同じ座標で同じ画像になるというものだが、実際はシナリオ作成中に何度もエラーになる。マッチング率を下げれば解消するのかもしれないが、そもそも何処がアンマッチでエラーになっているかもわからないので、安易にマッチング率を下げて対応して良いのかも不明だ。

開発時には通ったが、本番運用時はアンマッチエラーを吐くなんてことも頻発する。ロボットに任せっきりにしたいはずなのに、ちょくちょく止まっていないか確認しなければならない。

ボクのイメージでは「画像マッチング」は割と**最後の手段**的なイメージがあったのだが、かなりの頻度で利用しないとシナリオ作成が成り立たないような状態になっている。

## 複雑なエラーハンドリング

RPA はシナリオ実行中に予期しないエラー（指定のファイルが存在しない等）が発生するとそこで処理を終了してしまう。

「だったらそのシナリオ再実行すればいいじゃん」というレベルの業務であればそれでもいいんだけど、中にはリトライが許されないクリティカルな業務や、シナリオの実行時間自体が無視できないほど長かったりするものもある。そもそもエラーが発生していないかどうかを人がちょくちょく確認しなければならないこと自体がイケてないので、原則として**予期しないエラーは起きてはならない**ということを前提とする。

モダンなプログラミング言語であれば例外機構を備えているのでそれで対応できるが、RPA の場合そのような機構は存在しないので、一つ一つフローチャートにエラーの分岐を記述していかなければならない。少し想像すると分かるが、正常系のフローと異常系のフローが入り乱れたうえに凄まじく長大なフローができあがる。

実際のところそこまでやるのは不可能だ。

## 結局 VBS かよ

RPA には色々な処理が用意されているが、それでも対応できない場合は VBS を書くことで対応することができる。逆に言うと VBS で書かないと対応できない処理が多数あるということだ。

例えば「昨日の日付を取得する」という処理も VBS が必要になる。これくらいできないの？とも思うが、このレベルで VBS のお世話になるということは利用頻度は押して図るべしということか…

ていうか VBS 一択なの？辛すぎ…

## これ直せるの？

シナリオはフローチャート形式で進んでいくが、ユーザーの一動作が一つのブロックとして記述されるので、わりと簡単な業務でも結構な長さになる。さらに処理の抽象化ができないので、パターンでの条件分岐があると似たような後続処理を何度も記述しなければならない。更にはエラーハンドリングも必要だし、画像マッチング判定や VBS も不可避であれば……**これメンテできるの？**

# 学習コスト

## ノンコーディングと言われるけど

RPA はノンコーディングと言われているけど、ツールとして操作を習得するのは決して簡単ではなく学習コストは高いと感じる。少なくとも業務をフローチャートに起こす程度のスキルは必要だし、RPA が用意している処理コンポーネントもそれなりの数があるし、独自のルールを覚えたり、画像マッチングの勘所を抑えたり、もしかしたら VBA も覚えなければならないかもしれない。

プログラミング未経験者からすれば異論があると思うが少なくともボクの感覚から言うと、RPA の使い方を習得するコストを考えれば、**Python を覚えたほうがよっぽど早いのではないか**と思った。

未経験から Python というのは言うほど簡単ではないと思うが、それでも Python のほうが大変とは言い切れない。それほど**RPA でのシナリオ作りは大変だ**。ましてや Python であれば前述の問題点はほとんどクリアできる。

`※別にPythonじゃなくてもいいんだけど、一番覚えるのが簡単そうだからPythonにした。JavaでもC#でもJavaScriptでもRubyでもなんでもいいんじゃね？ただVBSは将来性ないと思うよ`

# 誰がやるべきか

そもそもルーチン業務の自動化って誰がやるべきなの？

## ユーザー部門がやるべきか

ユーザー部門がやる場合、担当者が自分の業務に対して自力で自動化をすることになると思う。

では作られたシナリオの妥当性は誰が検証するのだろうか？担当者の上司だろうか？…恐らくされないのではないかと思う。

担当者がルーチンワークとなる業務を自分でピックアップし、自分でシナリオを作成して自動化する。確かに短期的には効果があるかもしれないが、そのようなシナリオが乱立したとき、それらを管理しきれるだろうか？引き継ぎできるだろうか？メンテナンスできるだろうか？

恐らく Excel マクロの乱立と同じ道を辿ることは想像に難くないはずだ。

## システム部門がやるべきか

ではシステム部門がやるべきなのだろうか？心情的には"Yes"なのだが、RPA は明らかに**ユーザー部門が作ることを想定して作られている。**

まあそれでもユーザー部門に好き勝手にシナリオを作らせるよりは、システム部門で一括管理したほうがいいだろう。ただエラーの解決やシナリオのメンテナンス等もシステム部門が一手に引き受けることになる。

実際ユーザー部門に VBS を書けというのは酷ではないかな。かと言ってシステム部門なら書けるっていう保証もないんだけど…

## 自社システムならシステム改修を検討しよう

もし自社のシステムに対し RPA で自動化を図ろうとしているなら、それは本来あって然るべきな自動化であることに気付くべきだ。

「RPA を導入したことで効率化が果たされた」のではなく、本来自社システムが効率的にやるべき部分を効率化しきれていなかったので「RPA がそのツケを払っている」のだ。

システム改修で自動化が果たされるのであれば一番真っ当な解決方法だと思う。確かにコスト（お金）は掛かるだろう、しかし永続的に安定的な自動化が実現できるなら決して高くはないはずだ。RPA なら安価で安易に解決できるよう見えがちだが、**急がば廻れ**だ。

# さいごに

散々ネガティブキャンペーン張ってしまった。

改めて言うけど、ある製品を使っての感想なので、世の中の RPA 全部が全部ここまで酷いとは思っていない。
だからこれらの問題がそもそも無い RPA を使うか、もしくは問題を認識したうえで回避できるのであれば上手く活用できればいいのではないだろうか。

しかし RPA はライセンス形態にもよるが最低でも 100 万は超えると思ったほうがよく、決して安い買い物ではない。導入を検討する場合、是非試用版なりで実際使ってみることをオススメする。

ただ、やっぱり…

**RPA って制約多い上に覚えるのも作るのも大変だし、Python でやったほうがよくね？**
